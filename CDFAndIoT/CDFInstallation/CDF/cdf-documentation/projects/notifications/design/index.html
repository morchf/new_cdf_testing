



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.9.4">
    
    
      
        <title>NOTIFICATIONS: Design - Connected Device Framework (CDF)</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#notifications-design" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="Connected Device Framework (CDF)" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Connected Device Framework (CDF)
              </span>
              <span class="md-header-nav__topic">
                NOTIFICATIONS: Design
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../.." title="Connected Device Framework (CDF)" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Connected Device Framework (CDF)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="CONNECTED DEVICE FRAMEWORK (CDF)" class="md-nav__link">
      CONNECTED DEVICE FRAMEWORK (CDF)
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Advanced
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Advanced
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../advanced/cicd/" title="CI/CD" class="md-nav__link">
      CI/CD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../advanced/deployment/" title="Deployment" class="md-nav__link">
      Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../advanced/" title="Advanced Track" class="md-nav__link">
      Advanced Track
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Beginner
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Beginner
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../beginner/" title="Beginner Track" class="md-nav__link">
      Beginner Track
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Development
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../development/async/" title="Asynchronous Operations" class="md-nav__link">
      Asynchronous Operations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../development/config/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../development/dependency-injection/" title="Dependency Injection" class="md-nav__link">
      Dependency Injection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../development/prerequisites/" title="Prerequisites" class="md-nav__link">
      Prerequisites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../development/quickstart/" title="Development Getting Started" class="md-nav__link">
      Development Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../development/tech-stack/" title="Tech Stack" class="md-nav__link">
      Tech Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../development/unit-testing/" title="Unit testing" class="md-nav__link">
      Unit testing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Intermediate
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Intermediate
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../intermediate/" title="Intermediate Track" class="md-nav__link">
      Intermediate Track
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Postman
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Postman
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../postman/" title="Postman" class="md-nav__link">
      Postman
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      Projects
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Projects
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/" title="Connected Device Framework" class="md-nav__link">
      Connected Device Framework
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2">
    
    <label class="md-nav__link" for="nav-7-2">
      Assetlibrary
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-2">
        Assetlibrary
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../assetlibrary/assetlibrary-swagger/" title="Connected Device Framework: Asset Library" class="md-nav__link">
      Connected Device Framework: Asset Library
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../assetlibrary/events/" title="ASSET LIBRARY EVENTS" class="md-nav__link">
      ASSET LIBRARY EVENTS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../assetlibrary/fine-grained-access-control/" title="ASSET LIBRARY FINE-GRAINED ACCESS CONTROL" class="md-nav__link">
      ASSET LIBRARY FINE-GRAINED ACCESS CONTROL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../assetlibrary/modes/" title="ASSET LIBRARY MODES" class="md-nav__link">
      ASSET LIBRARY MODES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../assetlibrary/overview/" title="ASSET LIBRARY OVERVIEW" class="md-nav__link">
      ASSET LIBRARY OVERVIEW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../assetlibrary/profiles/" title="ASSET LIBRARY:  Profiles" class="md-nav__link">
      ASSET LIBRARY:  Profiles
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../assetlibrary/templates-developer/" title="ASSET LIBRARY:  Templates (Developer)" class="md-nav__link">
      ASSET LIBRARY:  Templates (Developer)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../assetlibrary/templates-user/" title="ASSET LIBRARY:  Templates (User)" class="md-nav__link">
      ASSET LIBRARY:  Templates (User)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3">
    
    <label class="md-nav__link" for="nav-7-3">
      Assetlibrary history
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-3">
        Assetlibrary history
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../assetlibrary-history/assetlibraryhistory-swagger/" title="Connected Device Framework: Asset Library History" class="md-nav__link">
      Connected Device Framework: Asset Library History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../assetlibrary-history/overview/" title="ASSET LIBRARY HISTORY OVERVIEW" class="md-nav__link">
      ASSET LIBRARY HISTORY OVERVIEW
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-4" type="checkbox" id="nav-7-4">
    
    <label class="md-nav__link" for="nav-7-4">
      Auth devicecert
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-4">
        Auth devicecert
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../auth-devicecert/overview/" title="CUSTOM DEVICE AUTHORIZER" class="md-nav__link">
      CUSTOM DEVICE AUTHORIZER
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-5" type="checkbox" id="nav-7-5">
    
    <label class="md-nav__link" for="nav-7-5">
      Bulkcerts
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-5">
        Bulkcerts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../bulkcerts/bulkcerts-swagger/" title="Connected Device Framework: Bulk Certs" class="md-nav__link">
      Connected Device Framework: Bulk Certs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../bulkcerts/overview/" title="BULK CERTS REST API" class="md-nav__link">
      BULK CERTS REST API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-6" type="checkbox" id="nav-7-6">
    
    <label class="md-nav__link" for="nav-7-6">
      Certificateactivator
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-6">
        Certificateactivator
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../certificateactivator/overview/" title="CERTIFICATE ACTIVATOR" class="md-nav__link">
      CERTIFICATE ACTIVATOR
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-7" type="checkbox" id="nav-7-7">
    
    <label class="md-nav__link" for="nav-7-7">
      Certificatevendor
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-7">
        Certificatevendor
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../certificatevendor/overview/" title="CERTIFICATE VENDOR" class="md-nav__link">
      CERTIFICATE VENDOR
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-8" type="checkbox" id="nav-7-8">
    
    <label class="md-nav__link" for="nav-7-8">
      Commands
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-8">
        Commands
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../commands/commands-swagger/" title="Connected Device Framework: Commands Service" class="md-nav__link">
      Connected Device Framework: Commands Service
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../commands/ephemeral-groups/" title="COMMANDS TARGETS" class="md-nav__link">
      COMMANDS TARGETS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../commands/overview/" title="COMMANDS REST API" class="md-nav__link">
      COMMANDS REST API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../commands/presigned-urls-developer/" title="COMMANDS PRE-SIGNED URLS" class="md-nav__link">
      COMMANDS PRE-SIGNED URLS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../commands/presigned-urls-user/" title="COMMANDS PRE-SIGNED URLS" class="md-nav__link">
      COMMANDS PRE-SIGNED URLS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-9" type="checkbox" id="nav-7-9">
    
    <label class="md-nav__link" for="nav-7-9">
      Devicemonitoring
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-9">
        Devicemonitoring
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../devicemonitoring/overview/" title="Device Monitoring Service" class="md-nav__link">
      Device Monitoring Service
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-10" type="checkbox" id="nav-7-10">
    
    <label class="md-nav__link" for="nav-7-10">
      Libraries
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-10">
        Libraries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../libraries/README/" title="CDF Reusable Libraries" class="md-nav__link">
      CDF Reusable Libraries
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-11" type="checkbox" id="nav-7-11" checked>
    
    <label class="md-nav__link" for="nav-7-11">
      Notifications
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-11">
        Notifications
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        NOTIFICATIONS: Design
      </label>
    
    <a href="./" title="NOTIFICATIONS: Design" class="md-nav__link md-nav__link--active">
      NOTIFICATIONS: Design
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#high-level-architecture" title="High Level Architecture" class="md-nav__link">
    High Level Architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processing-pipeline" title="Processing Pipeline" class="md-nav__link">
    Processing Pipeline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events-processor" title="Events Processor" class="md-nav__link">
    Events Processor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" title="API" class="md-nav__link">
    API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event-sources" title="Event Sources" class="md-nav__link">
    Event Sources
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamodb-streams" title="DynamoDB Streams" class="md-nav__link">
    DynamoDB Streams
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iot-core" title="IoT Core" class="md-nav__link">
    IoT Core
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event-filtering" title="Event Filtering" class="md-nav__link">
    Event Filtering
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-event-format" title="Common Event Format" class="md-nav__link">
    Common Event Format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rule-conditions" title="Rule Conditions" class="md-nav__link">
    Rule Conditions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-store" title="Data Store" class="md-nav__link">
    Data Store
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eventconfig-data-access-patterns" title="EventConfig Data Access Patterns" class="md-nav__link">
    EventConfig Data Access Patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventnotifications-data-access-patterns" title="EventNotifications Data Access Patterns" class="md-nav__link">
    EventNotifications Data Access Patterns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events-alerts" title="Events Alerts" class="md-nav__link">
    Events Alerts
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../events-processor-swagger/" title="Events processor swagger" class="md-nav__link">
      Events processor swagger
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../walkthrough/" title="Walkthrough" class="md-nav__link">
      Walkthrough
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-12" type="checkbox" id="nav-7-12">
    
    <label class="md-nav__link" for="nav-7-12">
      Provisioning
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-12">
        Provisioning
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../provisioning/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../provisioning/provisioning-swagger/" title="Provisioning swagger" class="md-nav__link">
      Provisioning swagger
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../provisioning/provisioning-templates/" title="Provisioning templates" class="md-nav__link">
      Provisioning templates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-13" type="checkbox" id="nav-7-13">
    
    <label class="md-nav__link" for="nav-7-13">
      Request queue
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-13">
        Request queue
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../request-queue/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#high-level-architecture" title="High Level Architecture" class="md-nav__link">
    High Level Architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processing-pipeline" title="Processing Pipeline" class="md-nav__link">
    Processing Pipeline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events-processor" title="Events Processor" class="md-nav__link">
    Events Processor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" title="API" class="md-nav__link">
    API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event-sources" title="Event Sources" class="md-nav__link">
    Event Sources
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamodb-streams" title="DynamoDB Streams" class="md-nav__link">
    DynamoDB Streams
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iot-core" title="IoT Core" class="md-nav__link">
    IoT Core
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event-filtering" title="Event Filtering" class="md-nav__link">
    Event Filtering
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-event-format" title="Common Event Format" class="md-nav__link">
    Common Event Format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rule-conditions" title="Rule Conditions" class="md-nav__link">
    Rule Conditions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-store" title="Data Store" class="md-nav__link">
    Data Store
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eventconfig-data-access-patterns" title="EventConfig Data Access Patterns" class="md-nav__link">
    EventConfig Data Access Patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventnotifications-data-access-patterns" title="EventNotifications Data Access Patterns" class="md-nav__link">
    EventNotifications Data Access Patterns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events-alerts" title="Events Alerts" class="md-nav__link">
    Events Alerts
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="notifications-design">NOTIFICATIONS: Design<a class="headerlink" href="#notifications-design" title="Permanent link">&para;</a></h1>
<p>The CDF Notifications service is comprised of 2 micro-services:  the CDF Events Processor, and the CDF Events Alerts. </p>
<h2 id="high-level-architecture">High Level Architecture<a class="headerlink" href="#high-level-architecture" title="Permanent link">&para;</a></h2>
<p><img alt="HLA" src="../images/cdf-notifications-hla.png" /></p>
<h2 id="processing-pipeline">Processing Pipeline<a class="headerlink" href="#processing-pipeline" title="Permanent link">&para;</a></h2>
<p><img alt="Pipeline" src="../images/cdf-notifications.draw.io-pipeline.png" /></p>
<h2 id="events-processor">Events Processor<a class="headerlink" href="#events-processor" title="Permanent link">&para;</a></h2>
<p>The Events Processor module is responsible for receiving events from external data sources, transforming to a common message format, filtering based on configured subscriptions, and finally storing the generated alerts for later forwarding by the Events Alerts module.</p>
<p>The Events Processor is implemented as a fat lambda, exposing a management REST API, along with multiple Lambda handler entry points for DynamoDB Stream triggers, and direct Lambda invocations.</p>
<p>Event definitions are defined which are comprised of the data sources to monitor, and the rule to apply.  Subscribers then create subscriptions for specific events occurring.  An example domain model:</p>
<p><img alt="DataModel" src="../images/cdf-notifications.draw.io-data-model.png" /></p>
<h2 id="api">API<a class="headerlink" href="#api" title="Permanent link">&para;</a></h2>
<p>The following REST API endpoints are exposed to configure events sources, events, and to allow user's to manage their subscriptions:</p>
<p>For a full definition of the endpoint including a description of the parameters, request and response bodies, and examples, refer to the <a href="../events-processor-swagger/">swagger definition</a>.</p>
<table>
<thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>POST /eventsources</code></td>
<td>Creates a new event source, both the integration itself and its metadata</td>
</tr>
<tr>
<td><code>GET /eventsources</code></td>
<td>List all event sources</td>
</tr>
<tr>
<td><code>GET /eventsources/{eventsourceId}</code></td>
<td>Returns a specific event source</td>
</tr>
<tr>
<td><code>DELETE /eventsources/{eventsourceId}</code></td>
<td>Deletes a specific event source, along with all its associated events and subscriptions</td>
</tr>
<tr>
<td><code>POST /eventsources/{eventSourceId}/events</code></td>
<td>Defines a new event</td>
</tr>
<tr>
<td><code>GET /eventsources/{eventSourceId}/events</code></td>
<td>Lists all events for a specific event source</td>
</tr>
<tr>
<td><code>GET /events/{eventId}</code></td>
<td>Returns a specific event</td>
</tr>
<tr>
<td><code>DELETE /events/{eventId}</code></td>
<td>Deletes an specific event, along with all its related subscriptions</td>
</tr>
<tr>
<td><code>POST /events/{eventId}/subscriptions</code></td>
<td>Subscribes to an event</td>
</tr>
<tr>
<td><code>GET /events/{eventId}/subscriptions</code></td>
<td>Lists all subscriptions for a specific event</td>
</tr>
<tr>
<td><code>GET /subscriptions/{subscriptionId}</code></td>
<td>Returns a specific event</td>
</tr>
<tr>
<td><code>GET /user/{userId}/subscriptions</code></td>
<td>Lists all subscriptions for a user</td>
</tr>
</tbody>
</table>
<h2 id="event-sources">Event Sources<a class="headerlink" href="#event-sources" title="Permanent link">&para;</a></h2>
<p>The following event sources are supported:</p>
<ul>
<li>DynamoDB stream</li>
<li>IoT Core (Lambda Invoke via IoT Rule)</li>
</ul>
<p>The following are planned to be suported:</p>
<ul>
<li>API Gateway</li>
</ul>
<p>All incoming events must contain an <code>eventSourceId</code> that can be used to match against a configured <code>EventSource</code> <code>eventSourceId</code>.  If a matching <code>EventSource</code> configuration cannot be found, the event is dropped.</p>
<p>Events that are sourced via direct lambda invocation, such as API Gateway or IoT Core, are expected to be in the common event format, whereas events sourced from DynamoDB Streams are converted to the common message format by the Event Processor.</p>
<h4 id="dynamodb-streams">DynamoDB Streams<a class="headerlink" href="#dynamodb-streams" title="Permanent link">&para;</a></h4>
<p>A DynamoDB Stream may be configured as a trigger to the Events Processor service. </p>
<p>Using DynamoDB streams as a Lambda trigger instead of consuming the DynamoDB Stream via Kinesis was chosen so that we benefit from automatic shard handling of scaling up/down.</p>
<p>Creating a DynamoDB Stream event source via the REST API will enable the stream if it is not already enabled on the table, whereas deleting the event source via the REST API will not disable the stream on the table incase since enabling, an external consumer has started consuming the stream.</p>
<p>The <code>eventSourceARN</code> in the incoming lambda event from the DynamoDB Stream trigger is used to determine which events are subject to processing by extracting the table portion of the Arn and matching it to an <code>EventSource</code>by its <code>eventSourceId</code>. </p>
<ul>
<li>Example eventSourceARN:  a<code>rn:aws:dynamodb:us-west-2:{account-id}:table/ExampleTableWithStream/stream/2015-06-27T00:48:05.899</code></li>
<li>Corresponding eventSourceId:  <code>arn:aws:dynamodb:us-west-2:{account-id}:table/ExampleTableWithStream</code></li>
</ul>
<p>The items primary key, sort key, and attributes, are extracted from the <code>NewImage</code> section of the event and transformed into the common event format for filtering.</p>
<h4 id="iot-core">IoT Core<a class="headerlink" href="#iot-core" title="Permanent link">&para;</a></h4>
<p>Creating an IoT Core event source via the REST API creates an IoT Rule to forward the event message.  Deleting via the REST API will remove the IoT Rule.</p>
<p>It is expected that the incoming event being forwarded from IoT Core (via an IoT Rule) is already in the common event format (defined as part of the IoT Rule SQL), therefore will not need transforming.</p>
<h2 id="event-filtering">Event Filtering<a class="headerlink" href="#event-filtering" title="Permanent link">&para;</a></h2>
<p>Takes as input an event of the common event format.  First performs a lookup to see if any subscriptions for the event are configured for the event source, principal and principal value.  If subscriptions are configured, then a ruleset specific for the principal is loaded.  If any of the subscription rules for the principal pass, and the subscription has not been alerted, the event alert is stored in DynamoDB for later dispatching by the Events Alerts module.  If the subscription rules for the principal do not pass, and the subscription had been alerted, the alerted flag is reset.</p>
<h4 id="common-event-format">Common Event Format<a class="headerlink" href="#common-event-format" title="Permanent link">&para;</a></h4>
<p>The <code>principal</code> represents the object that is the focus of the event message.  As an example, it could be the thing name or device id if the event message originated from a device, or a User Id if it originated directly from a user.</p>
<div class="highlight"><pre><span></span><span class="kr">interface</span> <span class="nx">CommonEvent</span> <span class="p">{</span>
    <span class="nx">eventSourceId</span>: <span class="kt">string</span><span class="p">;</span>
    <span class="nx">principal</span>: <span class="kt">string</span><span class="p">;</span>
    <span class="nx">principalValue</span>: <span class="kt">string</span><span class="p">;</span>
    <span class="nx">attributes</span><span class="o">?:</span> <span class="p">{</span> <span class="p">[</span><span class="nx">key</span>: <span class="kt">string</span><span class="p">]</span> <span class="o">:</span> <span class="kt">string</span><span class="o">|</span><span class="kr">boolean</span><span class="o">|</span><span class="kt">number</span><span class="o">|</span><span class="kt">string</span><span class="p">[]</span><span class="o">|</span><span class="kt">number</span><span class="p">[]</span> <span class="p">};</span>
<span class="p">}</span>
</pre></div>

<h4 id="rule-conditions">Rule Conditions<a class="headerlink" href="#rule-conditions" title="Permanent link">&para;</a></h4>
<p>Each rule requires a its conditions to be defined.  </p>
<p>A condition comprises of a <code>fact</code> (the attribute to check), an <code>operator</code>(e.g. <code>LessThan</code>), and a <code>value</code>.  In addition, multiple conditions may be defined within <code>all</code> or <code>any</code> constructs.</p>
<h2 id="data-store">Data Store<a class="headerlink" href="#data-store" title="Permanent link">&para;</a></h2>
<p>As this module is executed against telemetry, performance is critical, therefore DynamoDB is used as the datastore.  DynamoDB <code>BatchGetItem</code> and <code>BatchWriteItem</code> methods are used where possible to increase performance.</p>
<p>The following tables exist:</p>
<ul>
<li><strong>EventConfig</strong> - utilizes the <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/best-practices.html">Adjacency List Pattern, GSI Overloading and GSI Sharding best practices</a> to store <code>Event</code>, <code>EventSource</code> and <code>Subscription</code> information.  As the data access is read heavy, DynamoDB Accelerator <a href="https://aws.amazon.com/dynamodb/dax/">DAX</a> is enabled to improve read performance.</li>
<li><strong>EventNotifications</strong> - stores all processed alerts.  Streams the creation of new alerts to the Events Alerts modules.</li>
</ul>
<h4 id="eventconfig-data-access-patterns">EventConfig Data Access Patterns<a class="headerlink" href="#eventconfig-data-access-patterns" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Access Pattern</th>
<th>Query</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr>
<td>Find an EventSource by its id</td>
<td>Use table, PK="ES:{eventSourceId}", SK="type:ES"</td>
<td>EventSource</td>
</tr>
<tr>
<td>List all EventSource's</td>
<td>Use sk-gsi1Sort-index, PK="type:ES"</td>
<td>Multiple EventSources</td>
</tr>
<tr>
<td>List all active EventSource's</td>
<td>Use sk-gsi1Sort-index, PK="type:ES", SK begins_with "ES:true:"</td>
<td>Multiple EventSources</td>
</tr>
<tr>
<td>Find an Event by its id</td>
<td>Use sk-gsi1Sort-index, PK="E:{eventId}", SK begins_with "E:{eventId}:"</td>
<td>Multiple Events including denormalized  EventSource info</td>
</tr>
<tr>
<td>List all Event's</td>
<td>Use sk-gsi1Sort-index, PK="type:E"</td>
<td>Multiple Events</td>
</tr>
<tr>
<td>List all active Event's</td>
<td>Use sk-gsi1Sort-index, PK="type:E", SK beings_with "E:true:"</td>
<td>Multiple Events</td>
</tr>
<tr>
<td>List all Events of a given EventSource</td>
<td>Use table, PK="ES:{eventSourceId}", SK begins_with "E:"</td>
<td>Multiple Events including denormalized EventSource info</td>
</tr>
<tr>
<td>Find a Subscription by id</td>
<td>Use table, PK="S:{subscriptionId}", SK="S:{subscriptionId}"</td>
<td>Subscription</td>
</tr>
<tr>
<td>List all Subscriptions for an Event</td>
<td>Use sk-gsi1Sort-index, PK="E:{eventId}", SK begins_with "S:"</td>
<td>Multiple Subscriptions</td>
</tr>
<tr>
<td>List all Subscriptions for an Event</td>
<td>Use sk-gsi1Sort-index, PK="E:{eventId}", SK begins_with "S:"</td>
<td>Multiple Subscriptions</td>
</tr>
<tr>
<td>List all Subscriptions for a User</td>
<td>Use sk-gsi1Sort-index, PK="U:{userId1}", SK begins_with "S:"</td>
<td>Multiple Subscriptions</td>
</tr>
<tr>
<td>For an incoming message from an event source, retrieve the rule definitions (Event) and all rule parameter values (Subscriptions) to determine if an event message needs alerting</td>
<td>Use sk-gsi1Sort-index, PK="ES:{eventSourceId}:{principal}:{principalValue}"</td>
<td>Multiple Subscriptions including denormalized Event info</td>
</tr>
</tbody>
</table>
<h4 id="eventnotifications-data-access-patterns">EventNotifications Data Access Patterns<a class="headerlink" href="#eventnotifications-data-access-patterns" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Access Pattern</th>
<th>Query</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr>
<td>Stream all notifications for a user</td>
<td>Use userId-time-index, PK="{userId}"</td>
<td>Multiple Alerts</td>
</tr>
<tr>
<td>Stream all notifications for a user for a specific date range</td>
<td>Use userId-time-index, PK="{userId}", SK BETWEEN "{dateFrom}" and "{dateTo}"</td>
<td>Multiple Alerts</td>
</tr>
<tr>
<td>Stream notifications of a particular event for a user</td>
<td>Use userId-gsi2Sort-index, PK="{userId}", SK begins_with "E-{eventId1}-"</td>
<td>Multiple Alerts</td>
</tr>
<tr>
<td>Stream notifications of a particular event for a user for a specific date range</td>
<td>Use userId-gsi2Sort-index, PK="{userId}", SK BETWEEN "E-{eventId1}-{dateFrom}" and "E-{eventId1}-{dateTo}"</td>
<td>Multiple Alerts</td>
</tr>
</tbody>
</table>
<h2 id="events-alerts">Events Alerts<a class="headerlink" href="#events-alerts" title="Permanent link">&para;</a></h2>
<p>The Events Alerts module is responsible for notifying subscribers of generated alerts which are received by a DynamoDB Stream on the EventNotifications table that is populated by the Event Processor.  Notifications may be pushed to SNS or IoT Core, or alternatively queried in real-time via AppSync (planned feature).</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../libraries/README/" title="CDF Reusable Libraries" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                CDF Reusable Libraries
              </span>
            </div>
          </a>
        
        
          <a href="../events-processor-swagger/" title="Events processor swagger" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Events processor swagger
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.30f6b8b1.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../../.."}})</script>
      
    
    
      
    
  </body>
</html>